<!DOCTYPE html>
<html lang="zh">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no,minimal-ui" />
	<link rel="stylesheet" type="text/css" href="/blog/css/reset.css">
	<link rel="stylesheet" type="text/css" href="/blog/css/default.css">
	<link rel="stylesheet" type="text/css" href="/blog/css/prism_Solarized_Light.css">
	<link rel="stylesheet" type="text/css" href="/blog/css/iconmc.css">
	<link rel="shortcut icon"  href="/blog/favicon.ico">
	<script type="text/javascript" src="/blog/js/zeptoWithFx.min.js"></script>
	<title>å¾®ä¿¡å°ç¨‹åºå¼€å‘å‡ ç‚¹å¿ƒå¾—</title>
	
</head>
<body>
	<div class="header"></div>
	<div class="nav">
		<a href="/blog/index.html">Home</a>
		<a href="/blog/article.html">Article</a>
		<a href="/blog/aboutme.html">About me</a>
		<a href="/blog/csslib.html">Css lib</a>
	</div>
	<div class="aside"></div><div class="content"><h1>å¾®ä¿¡å°ç¨‹åºå¼€å‘å‡ ç‚¹å¿ƒå¾—</h1>
<p><img src="/blog/images/blog/wechat.jpg" alt="wechat"></p>
<p>21 Apr 2017</p>
<p>Author:wuguanxi</p>
<hr>
<p>æœ€è¿‘å¿™ç€å¼€å‘å¾®ä¿¡å°ç¨‹åºï¼Œå°ç¨‹åºçš„è¯­æ³•å¤§æ¦‚å€Ÿé‰´äº†Vue ã€ React è¿™äº›ä¸»æµæ¡†æ¶ï¼Œæ”¯æŒå¤§éƒ¨åˆ†css å’Œ ES6è¯­æ³•ï¼Œä½†ä¹Ÿä¼šæœ‰ä¸€äº›å‘ã€‚</p>
<h3>Promise</h3>
<p>æœ€æ–°ç‰ˆçš„å°ç¨‹åºæ”¯æŒ<a href="https://mp.weixin.qq.com/debug/wxadoc/dev/devtools/details.html">Promise</a>,ä½†çœŸæœºå®æµ‹æ—¶å‘ç°ç³»ç»Ÿä¸ºIOS8.3çš„iPhone5c Promiseæ— æ³•ä½¿ç”¨è€Œä¸”æ²¡æœ‰æŠ¥é”™ï¼Œå°è¯•ä½¿ç”¨ç¬¬ä¸‰æ–¹Promiseåº“<a href="http://bluebirdjs.com/docs/getting-started.html">bluebird</a>,ç»“æœæ‰è¿›å¦å¤–ä¸€ä¸ªå‘ã€‚</p>
<h3>bluebird</h3>
<p>bluebirdä»£ç ä¸­åŒ…å«æœ‰DOMæ“ä½œï¼Œä¸å°ç¨‹åº<strong>ä¸å…¼å®¹</strong>ã€‚
å¯ä»¥ç”¨<a href="https://www.npmjs.com/package/es6-promise">es6-promise</a>ä»£æ›¿ã€‚æ›¿æ¢åIOS8.3çš„iPhone5cå®æµ‹Promiseå¯ç”¨ã€‚</p>
<h3>å¸ƒå±€</h3>
<p>è¯·æ”¾å¿ƒä½¿ç”¨flexå¸ƒå±€ï¼Œç„¶åè®°å¾—åœ¨å¾®ä¿¡å¼€å‘è€…å·¥å…·é‡Œå‹¾é€‰ <strong>å¼€å¯ ä¸Šä¼ ä»£ç æ—¶æ ·å¼æ–‡ä»¶è‡ªåŠ¨ä¿å­˜</strong></p>
<h3>å°å›¾æ ‡</h3>
<p>å°ä½“ç§¯çš„å›¾æ ‡å¯ä»¥è½¬æ¢æˆbase64,ä½œä¸ºèƒŒæ™¯å›¾å¼•å…¥ï¼Œæ”¾åœ¨app.wxssé‡Œé¢å…¨å±€å¯ç”¨ã€‚</p>
<h3>ç»„ä»¶åŒ–</h3>
<p>å¾®ä¿¡å°ç¨‹åºä¸æä¾›ç»„ä»¶åŒ–çš„APIï¼Œä½†å¯ä»¥æœ‰æ–¹æ³•hackç±»ä¼¼çš„ç»„ä»¶ã€‚</p>
<h4>1.å¯¹Pageçš„åˆ†æ</h4>
<p>å°ç¨‹åºçš„Pageå…¶å®æ˜¯ä¸€ä¸ªæ™®é€šçš„jså¯¹è±¡ï¼Œç„¶åæœ‰ä¸€äº›è‡ªå¸¦çš„å±æ€§å’Œæ–¹æ³•ï¼Œè€Œä¸”å¯ä»¥éšæ„æ·»åŠ è‡ªå®šä¹‰çš„å±æ€§å’Œæ–¹æ³•ï¼Œæœ‰ä¸ªå…³é”®çš„æ–¹æ³•æ˜¯setData,å°ç¨‹åºå°±æ˜¯é å®ƒå®ç°æ•°æ®å’Œè§†å›¾çš„åŒæ­¥ã€‚
è€Œæˆ‘ä»¬ç»„ä»¶çš„ä¸€ä¸ªæ€è·¯å°±æ˜¯è·å–åˆ°Pageè¿™ä¸ªObject ,ç„¶åä¸ç»„ä»¶æä¾›çš„å±æ€§å’Œæ–¹æ³•è¿›è¡Œåˆå¹¶</p>
<h4>2.ç»„ä»¶</h4>
<p>æˆ‘çš„ç»„ä»¶loadingä¸ºä¾‹å­</p>
<pre><code class="language-bash">ç»„ä»¶ç»“æ„
loading--
  loading.js
  loading.wxml
  loading.wxss
</code></pre>
<p>loading.js</p>
<pre><code class="language-javascript">// loading.js loadingç»„ä»¶çš„js

// ç»„ä»¶çš„å±æ€§
const __data__ = {
  show:false
}
// ç»„ä»¶çš„æ–¹æ³•
const __fn__ = {
  ComponentLoadingShow(){
    this.data.ComponentLoadingData.show = true;
    const ComponentLoadingData = this.data.ComponentLoadingData;
    this.setData({
      ComponentLoadingData
    })
  },
  ComponentLoadingHide(){
    this.data.ComponentLoadingData.show = false;
    const ComponentLoadingData = this.data.ComponentLoadingData;
    this.setData({
      ComponentLoadingData
    })
  },
}

module.exports = function ComponentLoading(pageContext) {
   // è·å¾—page åˆå¹¶å±æ€§ä¸æ–¹æ³•
  const ComponentLoadingData = Object.assign({},__data__);
  pageContext.setData({
  // åœ¨ç»„ä»¶dataé‡Œçš„åå­—
    ComponentLoadingData
  });
  Object.assign(pageContext,__fn__);
}
</code></pre>
<pre><code class="language-javascript">// åœ¨Page indexé‡Œä½¿ç”¨

const ComponentLoading = require('../component/loading/loading.js');

Page({
  data: {
    
  },
  onLoad(){
    // onloadçš„æ—¶å€™æ³¨å…¥
    ComponentLoading(this);
  },
 
})

</code></pre>
<p>loading.wxml
wxmlæ–‡ä»¶æ˜¯å¯¹åº”çš„ç»“æ„ï¼Œä½¿ç”¨å°ç¨‹åºæä¾›çš„<a href="https://mp.weixin.qq.com/debug/wxadoc/dev/framework/view/wxml/template.html">æ¨¡æ¿ï¼ˆtemplateï¼‰</a></p>
<pre><code class="language-html">&lt;!-- loading.wxml--&gt;
&lt;template name=&quot;ComponentLoading&quot;&gt;
  &lt;view wx:if=&quot;&quot; class='ComponentLoading-loading' bindtap=&quot;&quot;&gt;
    &lt;view class=&quot;ComponentLoading-loading-icon&quot;&gt;&lt;/view&gt;
  &lt;/view&gt;
&lt;/template&gt;
</code></pre>
<p>ä½¿ç”¨æ—¶åœ¨Pageå¯¹åº”çš„wxmlå¼•å…¥</p>
<pre><code class="language-html">&lt;!-- index.wxml--&gt;
&lt;import src='../component/loading/loading.wxml' /&gt;
...
&lt;template is=&quot;ComponentLoading&quot; data=&quot;&quot;/&gt;
</code></pre>
<p>loading.wxss</p>
<pre><code class="language-css">.....
</code></pre>
<p>ç›´æ¥åœ¨app.wxssé‡Œé¢å¼•å…¥ï¼Œå…¨å±€å¯ç”¨</p>
<pre><code class="language-css">/**app.wxss**/
import './pages/component/loading/loading.wxss';
...
</code></pre>
<p><a href="https://github.com/Rococolate/wechat_app_loading">å®Œæ•´demoæŒ«è¿™é‡Œ</a></p>
<h3>æœ€åè¯´è¯´æˆæƒçš„å‘</h3>
<p>å°ç¨‹åºæœ‰äº›APIæ˜¯éœ€è¦ç”¨æˆ·æˆæƒæ‰èƒ½ç”¨ï¼Œä½†æ˜¯ï¼Œä¸€æ—¦ç”¨æˆ·ç¬¬ä¸€æ¬¡æ‰‹è¯¯æŒ‰äº†æ‹’ç»ï¼Œç¨‹åºåœ¨ä¸€ä¸ªä¸çŸ­çš„æ—¶é—´å†…æ˜¯æ— æ³•å†æ¬¡è°ƒèµ·æˆæƒAPIçš„ã€‚
è€Œä¸”è¿™ä¸ªå‘è²Œä¼¼åœ¨å°ç¨‹åº1.1.0å‰æ˜¯æ— è§£çš„ï¼Œ1.1.0çš„è§£å†³æ–¹æ³•æ˜¯ç”¨<a href="https://mp.weixin.qq.com/debug/wxadoc/dev/api/setting.html#opensettingobject">wx.openSetting</a>å¤„ç†
ä½ç‰ˆæœ¬éœ€è¦å…¼å®¹å¤„ç†ï¼ˆæç¤ºç”¨æˆ·å‡çº§å§ğŸ˜‚ï¼‰ã€‚</p>
</div>
	<script type="text/javascript" src="/blog/js/prism.js"></script>
	<script>
	  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

	  ga('create', 'UA-89176644-2', 'auto');
	  ga('send', 'pageview');

	</script>
</body>
</html>